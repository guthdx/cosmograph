---
phase: 06-react-frontend
plan: 02
type: execute
wave: 2
depends_on: [06-01]
files_modified:
  - frontend/src/components/FileUpload.tsx
  - frontend/src/components/FileUpload.css
  - frontend/src/components/ExtractionOptions.tsx
  - frontend/src/components/ExtractionOptions.css
  - frontend/src/components/LlmConfirmDialog.tsx
  - frontend/src/App.tsx
  - frontend/src/App.css
autonomous: true

must_haves:
  truths:
    - "User can drag and drop files onto upload area"
    - "User can click to select files via file picker"
    - "User can select extraction method from dropdown"
    - "User can enter custom graph title"
    - "LLM selection shows confirmation dialog before enabling"
  artifacts:
    - path: "frontend/src/components/FileUpload.tsx"
      provides: "Drag and drop file upload component"
      min_lines: 40
    - path: "frontend/src/components/ExtractionOptions.tsx"
      provides: "Extraction configuration form"
      min_lines: 30
    - path: "frontend/src/components/LlmConfirmDialog.tsx"
      provides: "LLM confirmation modal for data sovereignty"
      min_lines: 25
  key_links:
    - from: "frontend/src/components/FileUpload.tsx"
      to: "frontend/src/App.tsx"
      via: "onFilesSelected callback"
      pattern: "onFilesSelected"
    - from: "frontend/src/components/ExtractionOptions.tsx"
      to: "frontend/src/types/index.ts"
      via: "ExtractorType import"
      pattern: "ExtractorType"
---

<objective>
Create file upload and extraction options UI components.

Purpose: Enable users to select files and configure extraction parameters before starting processing.
Output: Working upload zone with drag-drop, extraction options form with LLM confirmation gate.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/milestones/v0.2.0/ROADMAP.md
@.planning/phases/06-react-frontend/06-RESEARCH.md
@frontend/src/types/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create FileUpload component</name>
  <files>
    frontend/src/components/FileUpload.tsx
    frontend/src/components/FileUpload.css
  </files>
  <action>
Create components directory and FileUpload.tsx using native HTML5 drag and drop API (no external library needed per research):

```tsx
// frontend/src/components/FileUpload.tsx
import { useState, DragEvent, ChangeEvent, useRef } from 'react';
import './FileUpload.css';

interface FileUploadProps {
  onFilesSelected: (files: File[]) => void;
  selectedFiles: File[];
  disabled?: boolean;
}

export function FileUpload({ onFilesSelected, selectedFiles, disabled }: FileUploadProps) {
  const [isDragging, setIsDragging] = useState(false);
  const inputRef = useRef<HTMLInputElement>(null);

  const handleDragOver = (e: DragEvent) => {
    e.preventDefault();
    if (!disabled) {
      setIsDragging(true);
    }
  };

  const handleDragLeave = (e: DragEvent) => {
    e.preventDefault();
    setIsDragging(false);
  };

  const handleDrop = (e: DragEvent) => {
    e.preventDefault();
    setIsDragging(false);
    if (!disabled) {
      const files = Array.from(e.dataTransfer.files);
      onFilesSelected([...selectedFiles, ...files]);
    }
  };

  const handleFileInput = (e: ChangeEvent<HTMLInputElement>) => {
    if (e.target.files) {
      onFilesSelected([...selectedFiles, ...Array.from(e.target.files)]);
    }
  };

  const handleClick = () => {
    if (!disabled) {
      inputRef.current?.click();
    }
  };

  const removeFile = (index: number) => {
    const newFiles = selectedFiles.filter((_, i) => i !== index);
    onFilesSelected(newFiles);
  };

  return (
    <div className="file-upload">
      <div
        className={`drop-zone ${isDragging ? 'dragging' : ''} ${disabled ? 'disabled' : ''}`}
        onDragOver={handleDragOver}
        onDragLeave={handleDragLeave}
        onDrop={handleDrop}
        onClick={handleClick}
      >
        <input
          ref={inputRef}
          type="file"
          multiple
          onChange={handleFileInput}
          disabled={disabled}
          accept=".txt,.md,.pdf"
        />
        <p className="drop-text">
          {isDragging ? 'Drop files here' : 'Drag & drop files here, or click to select'}
        </p>
        <p className="supported-formats">Supported: .txt, .md, .pdf</p>
      </div>

      {selectedFiles.length > 0 && (
        <div className="file-list">
          <h4>Selected files ({selectedFiles.length})</h4>
          <ul>
            {selectedFiles.map((file, index) => (
              <li key={`${file.name}-${index}`}>
                <span className="file-name">{file.name}</span>
                <span className="file-size">({(file.size / 1024).toFixed(1)} KB)</span>
                <button
                  type="button"
                  className="remove-btn"
                  onClick={(e) => {
                    e.stopPropagation();
                    removeFile(index);
                  }}
                  disabled={disabled}
                >
                  Remove
                </button>
              </li>
            ))}
          </ul>
        </div>
      )}
    </div>
  );
}
```

Create FileUpload.css:

```css
/* frontend/src/components/FileUpload.css */
.file-upload {
  margin-bottom: 20px;
}

.drop-zone {
  border: 2px dashed #666;
  border-radius: 8px;
  padding: 40px 20px;
  text-align: center;
  cursor: pointer;
  transition: all 0.2s ease;
  background: #1a1a1a;
}

.drop-zone:hover:not(.disabled) {
  border-color: #4fc3f7;
  background: rgba(79, 195, 247, 0.05);
}

.drop-zone.dragging {
  border-color: #4fc3f7;
  background: rgba(79, 195, 247, 0.1);
}

.drop-zone.disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.drop-zone input[type="file"] {
  display: none;
}

.drop-text {
  margin: 0 0 8px;
  font-size: 16px;
  color: #ccc;
}

.supported-formats {
  margin: 0;
  font-size: 12px;
  color: #888;
}

.file-list {
  margin-top: 16px;
  padding: 12px;
  background: #2a2a2a;
  border-radius: 4px;
}

.file-list h4 {
  margin: 0 0 8px;
  font-size: 14px;
  color: #ccc;
}

.file-list ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.file-list li {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 0;
  border-bottom: 1px solid #333;
}

.file-list li:last-child {
  border-bottom: none;
}

.file-name {
  flex: 1;
  color: #fff;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.file-size {
  color: #888;
  font-size: 12px;
}

.remove-btn {
  padding: 2px 8px;
  font-size: 12px;
  background: #444;
  border: none;
  border-radius: 3px;
  color: #ccc;
  cursor: pointer;
}

.remove-btn:hover:not(:disabled) {
  background: #c62828;
  color: #fff;
}

.remove-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}
```
  </action>
  <verify>
`cd frontend && npx tsc --noEmit` passes.
Visual inspection: import FileUpload in App.tsx temporarily to verify rendering.
  </verify>
  <done>FileUpload component with drag-drop, file picker, and file list display</done>
</task>

<task type="auto">
  <name>Task 2: Create ExtractionOptions and LlmConfirmDialog components</name>
  <files>
    frontend/src/components/ExtractionOptions.tsx
    frontend/src/components/ExtractionOptions.css
    frontend/src/components/LlmConfirmDialog.tsx
    frontend/src/components/LlmConfirmDialog.css
  </files>
  <action>
Create ExtractionOptions.tsx for method selection and title input:

```tsx
// frontend/src/components/ExtractionOptions.tsx
import { useState } from 'react';
import type { ExtractorType, ExtractionOptions as Options } from '../types';
import { LlmConfirmDialog } from './LlmConfirmDialog';
import './ExtractionOptions.css';

interface ExtractionOptionsProps {
  options: Options;
  onChange: (options: Options) => void;
  disabled?: boolean;
}

const EXTRACTOR_DESCRIPTIONS: Record<ExtractorType, string> = {
  auto: 'Automatically detect document type',
  legal: 'Legal documents (codes, ordinances)',
  text: 'Plain text and markdown',
  generic: 'Pattern-based extraction',
  pdf: 'PDF documents',
  llm: 'AI-powered extraction (Claude)',
};

export function ExtractionOptions({ options, onChange, disabled }: ExtractionOptionsProps) {
  const [showLlmDialog, setShowLlmDialog] = useState(false);
  const [pendingLlmConfirm, setPendingLlmConfirm] = useState(false);

  const handleExtractorChange = (e: React.ChangeEvent<HTMLSelectElement>) => {
    const newExtractor = e.target.value as ExtractorType;

    if (newExtractor === 'llm') {
      // Show confirmation dialog for LLM (data sovereignty gate)
      setShowLlmDialog(true);
      setPendingLlmConfirm(true);
    } else {
      onChange({ ...options, extractor: newExtractor, llmConfirmed: false });
    }
  };

  const handleLlmConfirm = () => {
    setShowLlmDialog(false);
    setPendingLlmConfirm(false);
    onChange({ ...options, extractor: 'llm', llmConfirmed: true });
  };

  const handleLlmCancel = () => {
    setShowLlmDialog(false);
    setPendingLlmConfirm(false);
    // Keep previous extractor selection
  };

  const handleTitleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    onChange({ ...options, title: e.target.value });
  };

  return (
    <div className="extraction-options">
      <div className="option-group">
        <label htmlFor="extractor">Extraction Method</label>
        <select
          id="extractor"
          value={pendingLlmConfirm ? options.extractor : options.extractor}
          onChange={handleExtractorChange}
          disabled={disabled}
        >
          <option value="auto">Auto-detect</option>
          <option value="legal">Legal Documents</option>
          <option value="text">Plain Text</option>
          <option value="generic">Pattern-based</option>
          <option value="pdf">PDF</option>
          <option value="llm">AI (Claude) - requires confirmation</option>
        </select>
        <p className="option-description">{EXTRACTOR_DESCRIPTIONS[options.extractor]}</p>
      </div>

      <div className="option-group">
        <label htmlFor="title">Graph Title</label>
        <input
          id="title"
          type="text"
          value={options.title}
          onChange={handleTitleChange}
          placeholder="Knowledge Graph"
          disabled={disabled}
        />
      </div>

      {options.extractor === 'llm' && options.llmConfirmed && (
        <div className="llm-confirmed-notice">
          AI extraction enabled - document content will be sent to Claude API
        </div>
      )}

      <LlmConfirmDialog
        isOpen={showLlmDialog}
        onConfirm={handleLlmConfirm}
        onCancel={handleLlmCancel}
      />
    </div>
  );
}
```

Create ExtractionOptions.css:

```css
/* frontend/src/components/ExtractionOptions.css */
.extraction-options {
  margin-bottom: 20px;
}

.option-group {
  margin-bottom: 16px;
}

.option-group label {
  display: block;
  margin-bottom: 6px;
  font-size: 14px;
  font-weight: 500;
  color: #ccc;
}

.option-group select,
.option-group input[type="text"] {
  width: 100%;
  padding: 10px 12px;
  font-size: 14px;
  background: #2a2a2a;
  border: 1px solid #444;
  border-radius: 4px;
  color: #fff;
}

.option-group select:focus,
.option-group input:focus {
  outline: none;
  border-color: #4fc3f7;
}

.option-group select:disabled,
.option-group input:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.option-description {
  margin: 6px 0 0;
  font-size: 12px;
  color: #888;
}

.llm-confirmed-notice {
  padding: 10px;
  background: rgba(255, 152, 0, 0.1);
  border: 1px solid #ff9800;
  border-radius: 4px;
  color: #ffb74d;
  font-size: 13px;
}
```

Create LlmConfirmDialog.tsx for data sovereignty confirmation:

```tsx
// frontend/src/components/LlmConfirmDialog.tsx
import './LlmConfirmDialog.css';

interface LlmConfirmDialogProps {
  isOpen: boolean;
  onConfirm: () => void;
  onCancel: () => void;
}

export function LlmConfirmDialog({ isOpen, onConfirm, onCancel }: LlmConfirmDialogProps) {
  if (!isOpen) return null;

  return (
    <div className="dialog-overlay" onClick={onCancel}>
      <div className="dialog" onClick={e => e.stopPropagation()}>
        <h3>Enable AI Extraction?</h3>
        <p>
          <strong>Data Sovereignty Notice:</strong> Using AI extraction will send your
          document content to the Claude API (Anthropic).
        </p>
        <p>Please confirm you have authorization to send this data externally.</p>
        <div className="dialog-actions">
          <button type="button" className="btn-cancel" onClick={onCancel}>
            Cancel
          </button>
          <button type="button" className="btn-confirm" onClick={onConfirm}>
            I Confirm
          </button>
        </div>
      </div>
    </div>
  );
}
```

Create LlmConfirmDialog.css:

```css
/* frontend/src/components/LlmConfirmDialog.css */
.dialog-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.dialog {
  background: #1e1e1e;
  border: 1px solid #444;
  border-radius: 8px;
  padding: 24px;
  max-width: 400px;
  margin: 20px;
}

.dialog h3 {
  margin: 0 0 16px;
  color: #ff9800;
}

.dialog p {
  margin: 0 0 12px;
  color: #ccc;
  line-height: 1.5;
}

.dialog-actions {
  display: flex;
  gap: 12px;
  justify-content: flex-end;
  margin-top: 20px;
}

.btn-cancel {
  padding: 10px 20px;
  background: #444;
  border: none;
  border-radius: 4px;
  color: #ccc;
  cursor: pointer;
  font-size: 14px;
}

.btn-cancel:hover {
  background: #555;
}

.btn-confirm {
  padding: 10px 20px;
  background: #ff9800;
  border: none;
  border-radius: 4px;
  color: #000;
  cursor: pointer;
  font-weight: 500;
  font-size: 14px;
}

.btn-confirm:hover {
  background: #ffa726;
}
```
  </action>
  <verify>
`cd frontend && npx tsc --noEmit` passes.
Components render without errors when imported.
  </verify>
  <done>ExtractionOptions with extractor dropdown, title input, and LLM confirmation dialog</done>
</task>

<task type="auto">
  <name>Task 3: Integrate components into App</name>
  <files>
    frontend/src/App.tsx
    frontend/src/App.css
  </files>
  <action>
Update App.tsx to use the new components with state management:

```tsx
// frontend/src/App.tsx
import { useState } from 'react';
import { FileUpload } from './components/FileUpload';
import { ExtractionOptions } from './components/ExtractionOptions';
import type { ExtractionOptions as Options } from './types';
import './App.css';

function App() {
  const [files, setFiles] = useState<File[]>([]);
  const [options, setOptions] = useState<Options>({
    extractor: 'auto',
    title: 'Knowledge Graph',
    llmConfirmed: false,
  });
  const [isProcessing] = useState(false);

  const canStartExtraction = files.length > 0;

  const handleStartExtraction = () => {
    // Will be implemented in Plan 03
    console.log('Starting extraction with:', { files, options });
  };

  return (
    <div className="app">
      <header className="app-header">
        <h1>Cosmograph</h1>
        <p>Document-to-Knowledge-Graph Service</p>
      </header>

      <main className="app-main">
        <section className="upload-section">
          <h2>1. Select Files</h2>
          <FileUpload
            onFilesSelected={setFiles}
            selectedFiles={files}
            disabled={isProcessing}
          />
        </section>

        <section className="options-section">
          <h2>2. Configure Extraction</h2>
          <ExtractionOptions
            options={options}
            onChange={setOptions}
            disabled={isProcessing}
          />
        </section>

        <section className="action-section">
          <button
            type="button"
            className="btn-extract"
            onClick={handleStartExtraction}
            disabled={!canStartExtraction || isProcessing}
          >
            {isProcessing ? 'Processing...' : 'Start Extraction'}
          </button>
        </section>

        {/* Progress, results, and error display will be added in Plan 03 */}
      </main>
    </div>
  );
}

export default App;
```

Update App.css with complete layout styles:

```css
/* frontend/src/App.css */
* {
  box-sizing: border-box;
}

body {
  margin: 0;
  background: #121212;
  color: #fff;
}

.app {
  max-width: 800px;
  margin: 0 auto;
  padding: 20px;
  font-family: system-ui, -apple-system, sans-serif;
}

.app-header {
  margin-bottom: 32px;
  padding-bottom: 16px;
  border-bottom: 1px solid #333;
}

.app-header h1 {
  margin: 0 0 4px;
  font-size: 28px;
  color: #4fc3f7;
}

.app-header p {
  margin: 0;
  color: #888;
  font-size: 14px;
}

.app-main {
  display: flex;
  flex-direction: column;
  gap: 24px;
}

section h2 {
  margin: 0 0 12px;
  font-size: 16px;
  font-weight: 500;
  color: #aaa;
}

.action-section {
  padding-top: 8px;
}

.btn-extract {
  width: 100%;
  padding: 14px 24px;
  font-size: 16px;
  font-weight: 500;
  background: #4fc3f7;
  border: none;
  border-radius: 6px;
  color: #000;
  cursor: pointer;
  transition: background 0.2s;
}

.btn-extract:hover:not(:disabled) {
  background: #29b6f6;
}

.btn-extract:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}
```
  </action>
  <verify>
1. `cd frontend && npm run dev` - starts without errors
2. Visit http://localhost:5173 - shows upload UI
3. Drag-drop files work
4. File picker works
5. Extractor dropdown changes description
6. Selecting LLM shows confirmation dialog
7. Start Extraction button disabled when no files
  </verify>
  <done>App with integrated FileUpload and ExtractionOptions, ready for extraction logic</done>
</task>

</tasks>

<verification>
1. `cd frontend && npx tsc --noEmit` passes (no type errors)
2. `cd frontend && npm run dev` starts successfully
3. FileUpload accepts drag-drop and file picker input
4. File list shows selected files with remove option
5. ExtractionOptions dropdown shows all extractor types
6. Selecting LLM extractor shows confirmation dialog
7. Title input updates the options state
8. Start Extraction button disabled when no files selected
</verification>

<success_criteria>
- Drag and drop file upload works
- File picker fallback works
- Selected files display with remove option
- Extractor type selection with descriptions
- LLM confirmation dialog for data sovereignty
- Graph title input field
- Start Extraction button with disabled state
</success_criteria>

<output>
After completion, create `.planning/phases/06-react-frontend/06-02-SUMMARY.md`
</output>
